## 아이템 17 - 변경 가능성을 최소화 하라 - 핵심 정리
---
### 불변 클래스

불변 클래스란 __한번 만들어지면 그 인스턴스의 상태가 바뀌지 않는 것__ 을 말한다.

그 인스턴스가 소멸될 때까지 인스턴스의 내부의 값들이 변경되지 않는 것이다.

이렇게 설계된 클래스를 __불변 클래스__ 라고 하고 불변 클래스의 인스턴스를 __불변 인스턴스__ 라고 한다.

불변 클래스를 만들기위한 다섯가지 규칙이 있다.

- 객체의 상태를 변경하는 메서드를 제공하지 않는다.

```java
public class PhoneNumber {

    private short areaCode, prefix, lineNum;

    public void setAreaCode(short areaCode) {
        this.areaCode = areaCode;
    }

    public void setPrefix(short prefix) {
        this.prefix = prefix;
    }

    public void setLineNum(short lineNum) {
        this.lineNum = lineNum;
    }

    public short getAreaCode() {
        return areaCode;
    }  

    public short getPrefix() {
        return prefix;
    }

    public short getLineNum() {
        return lineNum;
    }
}
```
위의 클래스처럼 상태를 변경할 수 있는 ``setter`` 를 제공하면 안된다.

```java
public class PhoneNumber {

   private short areaCode, prefix, lineNum;

   public PhoneNumber(short areaCode, short prefix, short lineNum) {
      this.areaCode = areaCode;
      this.prefix = prefix;
      this.lineNum = lineNum;
   }

   public short getAreaCode() {
      return areaCode;
   }

   public short getPrefix() {
      return prefix;
   }

   public short getLineNum() {
      return lineNum;
   }
}
```
위처럼 생성자를 통해 객체를 처음 만들 때 값을 받은 뒤 객체의 값을 변경하는 메서드를 제공하지 않는다.

- 상속을 할 수 없도록 막는다.

```java
public class PhoneNumber {

   private short areaCode, prefix, lineNum;

   public PhoneNumber(short areaCode, short prefix, short lineNum) {
      this.areaCode = areaCode;
      this.prefix = prefix;
      this.lineNum = lineNum;
   }

   public short getAreaCode() {
      return areaCode;
   }

   public short getPrefix() {
      return prefix;
   }

   public short getLineNum() {
      return lineNum;
   }
}
```
위의 클래스는 상속을 허용한 상태이다.

class 에 ``final`` 키워드가 없기 때문이고, ``public`` 생성자를 가지고 있기 때문이기도 하다.

```java
public class MyPhoneNumber extends PhoneNumber {

   public MyPhoneNumber(short areaCode, short prefix, short lineNum) {
      super(areaCode, prefix, lineNum);
   }
   
   private String name;

   public String getName() {
      return name;
   }

   public void setName(String name) {
      this.name = name;
   }
}
```
MyPhoneNumber 클래스는 PhoneNumber 를 상속받아 PhoneNumber 타입으로 사용할 수 있다.

PhoneNumber 는 불변 클래스를 의도했지만 MyPhoneNumber 는 값을 언제든지 변경할 수 있다.

불변 클래스를 상속받으면서 불변 클래스가 아니게된다.

```java
public final class PhoneNumber {

   private short areaCode, prefix, lineNum;

   public PhoneNumber(short areaCode, short prefix, short lineNum) {
      this.areaCode = areaCode;
      this.prefix = prefix;
      this.lineNum = lineNum;
   }

   public short getAreaCode() {
      return areaCode;
   }

   public short getPrefix() {
      return prefix;
   }

   public short getLineNum() {
      return lineNum;
   }
}
```
이러한 문제를 방지하기 위해서는 상속을 막아야한다.

상속을 막는 방법은 __final 클래스__ 를 만들거나 ``private`` 생성자만 가지고 있게 만들면 된다.

- 모든 필드를 final 로 선언한다.

필드를 변경할 수 없도록 ``final`` 로 선언한다.

```java
public final class PhoneNumber {

    private short areaCode, prefix, lineNum;

    public PhoneNumber(short areaCode, short prefix, short lineNum) {
        this.areaCode = areaCode;
        this.prefix = prefix;
        this.lineNum = lineNum;
    }

    public short getAreaCode() {
        return areaCode;
    }

    public short getPrefix() {
        return prefix;
    }

    public short getLineNum() {
        return lineNum;
    }
    
    public void doSomething() {
       this.areaCode = 10;
    }
}
```
``final`` 로 선언하지 않았다면 누군가가 실수로 해당 클래스의 메서드 안에서 값을 변경하는 경우가 발생할 수 있다.

```java
public final class PhoneNumber {

    private final short areaCode, prefix, lineNum;

    public PhoneNumber(short areaCode, short prefix, short lineNum) {
        this.areaCode = areaCode;
        this.prefix = prefix;
        this.lineNum = lineNum;
    }

    public short getAreaCode() {
        return areaCode;
    }

    public short getPrefix() {
        return prefix;
    }

    public short getLineNum() {
        return lineNum;
    }

   public void doSomething() {
      this.areaCode = 10; // final 키워드 사용으로 인해 해당 코드에 컴파일 에러가난다.
   }
}
```
이러한 경우를 막기위해 모든 필드를 ``final`` 키워드로 선언하도록 한다.

``final`` 키워드는 쓸 수 있다면 사용할 수 있다면 최대한 사용하도록 해야한다.

성능적인 장점도 있고, 프로그램을 견고하게 만들어 주는 장점이 있다.

- 모든 필드를 private 으로 선언한다.

```java
public final class PhoneNumber {

    public final short areaCode, prefix, lineNum;

    public PhoneNumber(short areaCode, short prefix, short lineNum) {
        this.areaCode = areaCode;
        this.prefix = prefix;
        this.lineNum = lineNum;
    }

    public short getAreaCode() {
        return areaCode;
    }

    public short getPrefix() {
        return prefix;
    }

    public short getLineNum() {
        return lineNum;
    }

   public void doSomething() {
      this.areaCode = 10; // final 키워드 사용으로 인해 해당 코드에 컴파일 에러가난다.
   }
}
```
위처럼 public 필드라면 



